/**
 *
 *
 *
 */function stripNoAlphaChars(e){e=e.replace(/ /g,"_");e=e.replace(/Ä/g,"Ae");e=e.replace(/ä/g,"ae");e=e.replace(/Ö/g,"Oe");e=e.replace(/ö/g,"oe");e=e.replace(/Ü/g,"Ue");e=e.replace(/ü/g,"ue");e=e.replace(/ß/g,"ss");e=e.replace(/\W/g,"_");return e}function confirmDestroy(e,t){if(confirm(lang.confirm_destroy))if($("#"+t).length){$("#"+t).effect("highlight",{mode:"hide"},2e3);$.post(e+".json?method=delete")}else parent.location.href=e+"?method=delete"}function countCharLength(e,t){var n=$(e),r=t===undefined?n.prop("maxlength"):t;$(e).next().html(r-n.val().length)}function getSizeOfFiles(e){if(typeof window.FileReader!="function"||!e.files||!e.files[0])return 0;var t=0,n=e.files.length;for(var r=0;r<n;r++)t+=e.files[r].size;return t}function checkFileSize(e,t,n){var r=getSizeOfFiles(e[0]),i=e.closest(".control-group"),s="file-input-help";if(r>t){i.addClass("alert alert-error");if($("#"+s).length)$("#"+s).removeClass("invisible");else{var o=$('<span class="help-inline" id="'+s+'">'+n+"</span>");e.after(o)}}else $("#"+s).fadeOut(function(){$(this).remove();i.find(".help-inline").length||i.removeClass("alert alert-error")})}function enableInfiniteScroll(e,t,n,r){$(e).infinitescroll({navSelector:"div.pagination",nextSelector:"div.pagination a:first",itemSelector:t,loading:{msgText:"",img:r+"/candy.global/loading.gif",finishedMsg:"",selector:"div.js-pagination",finished:function(e){e.loading.msg.fadeOut(e.loading.speed);iCounter+=1;if(iCounter%n===0){e.contentSelector.infinitescroll("pause");var t=$('<a alt="'+lang.pages.more+'" data-role="button" class="btn">'+lang.pages.more+"</a>");t.click(function(){$(this).fadeOut(e.loading.speed,function(){e.contentSelector.infinitescroll("resume")})});$(e.loading.selector).append(t)}return!0}},animate:!0})}function showFlashMessage(e,t){$("#js-flash_message").show().children().attr("id","js-flash_"+e).attr("class","alert alert-"+e);$("#js-flash_"+e+" a").remove();$("#js-flash_"+e+" p").html(t);$("#js-flash_message").delay("10000").slideUp()}function hide(e,t){$(e).delay(t).slideUp()}function show(e){$(e).show();($("#js-flash_success")||$("#js-flash_error"))&&hide(e,1e4)}function prepareForUpload(){$("#js-progress_bar").css("width","0%");$("#js-progress").toggle()}function upload(e,t,n,r,i,s){$(".control-group").removeClass("alert alert-error");var o=document.querySelector("#input-"+r).files,u=new FormData;for(var a=0,f;f=o[a];++a)u.append("file["+a+"]",f);if(i.length){$("#input-"+i).click(function(){$(this).closest().removeClass("alert alert-error");$(".help-inline").remove()});$.each($("form").serializeArray(),function(e,t){u.append(t.name,t.value)})}var l=new XMLHttpRequest;l.open("POST","/"+t+".json",!0);l.upload.onprogress=function(e){if(e.lengthComputable){var t=e.loaded/e.total*100;$("#js-progress_bar").css("width",t+"%")}};l.onload=function(){$("#js-progress").toggle();var e=JSON.parse(l.response);if(e.success===!0){var t=lang.upload_successful;if(n==="medias"||n==="downloads"||n==="galleries"){t=t+" "+lang.reloading;$(".form-horizontal").toggle()}else if(n==="users"){$("#js-avatar_thumb").attr("src",e.fileData.thumbnail);$("#js-avatar_link").attr("href",e.fileData.popup)}$(".control-group input").val("");showFlashMessage("success",t);s===!0&&setTimeout(function(){location.reload()},3e3)}else{e.error&&$.each(e.error,function(e,t){$("#input-"+e).closest(".control-group").addClass("alert alert-error");$("#input-"+e).parent().append("<span class='help-inline'>"+t+"</span>");$("#input-"+e).next().remove()});showFlashMessage("error",lang.upload_error)}};l.send(u)}function showAjaxUpload(e,t,n){$("p.center a").click(function(){if($("#"+e).length===0){$(".page-header").after("<div id='"+e+"'></div>");$("#"+e).load("/"+t+"/"+n+".ajax")}else $(".form-horizontal").toggle()})}var iCounter=0;$.fn.toggleOpacity=function(e){e?this.stop(!0,!0).animate({opacity:1}):this.stop(!0,!0).animate({opacity:.25})};$("#js-flash_success, #js-flash_error, #js-flash_warning").length&&show("#js-flash_message");$("#js-flash_success, #js-flash_error, #js-flash_warning").click(function(){hide(this,0)});$(".js-tooltip").length&&$(".js-tooltip").tooltip();$("p.error").length&&$("p.error").tooltip();$("input[maxlength]").each(function(){$(this).bind("keyup",function(){countCharLength(this)})});